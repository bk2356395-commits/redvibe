{% extends "base.html" %}
{% load static %}

{% block content %}
<nav>
    <a href="{% url 'home' %}">Home</a> |
    {% if user.is_authenticated %}
        <a href="{% url 'upload' %}">Upload</a> |
        <a href="{% url 'profile_view' %}">Profile</a> |
        <a href="{% url 'logout' %}">Logout</a>
    {% else %}
        <a href="{% url 'login' %}">Login</a> |
        <a href="{% url 'signup' %}">Sign Up</a>
    {% endif %}
</nav>

<h1>Home</h1>

{% for post in posts %}
<div class="post-card">
    <h2>{{ post.creator.username }}</h2>

    {% if post.media_type == "image" %}
        <img src="{{ post.media.url }}" alt="Post Image" class="post-media"/>
    {% else %}
        <video controls class="post-media">
            <source src="{{ post.media.url }}" type="video/mp4">
        </video>
    {% endif %}

    <p>{{ post.description }}</p>

    {% if user.is_authenticated %}
        {% if post.is_following_creator %}
            <button class="btn-following">Following</button>
        {% else %}
            <button class="btn-follow">Follow</button>
        {% endif %}
    {% else %}
        <p><a href="{% url 'login' %}">Login to follow</a></p>
    {% endif %}

    <p>Likes: {{ post.likes_set.count }}</p>
    <p>Comments: {{ post.comments.count }}</p>
</div>
<hr>
{% empty %}
<p>No posts found.</p>
{% endfor %}

{% endblock %}
